{
  "$schema": "https://claude.ai/schemas/hooks.json",
  "version": "1.0.0",
  "hooks": [
    {
      "name": "load-nomad-context",
      "event": "SessionStart",
      "description": "Load NOMAD configuration and check cache freshness on session start",
      "command": "bash .claude-plugin/hooks/scripts/load-nomad-context.sh",
      "timeout": 5000,
      "failureMode": "warn"
    },
    {
      "name": "validate-cve-format",
      "event": "UserPromptSubmit",
      "description": "Validate CVE identifiers in user queries and suggest corrections",
      "command": "bash .claude-plugin/hooks/scripts/validate-cve-format.sh \"$PROMPT\"",
      "timeout": 1000,
      "failureMode": "warn"
    },
    {
      "name": "check-setup-completion",
      "event": "UserPromptSubmit",
      "description": "Check if NOMAD setup is complete before operational queries",
      "command": "bash .claude-plugin/hooks/scripts/check-setup-status.sh \"$PROMPT\"",
      "timeout": 1000,
      "failureMode": "warn"
    },
    {
      "name": "verify-threat-source",
      "event": "PreToolUse",
      "toolPattern": "WebFetch",
      "description": "Verify WebFetch targets are legitimate threat intelligence sources",
      "command": "bash .claude-plugin/hooks/scripts/verify-threat-source.sh \"$URL\"",
      "timeout": 2000,
      "failureMode": "warn"
    },
    {
      "name": "log-threat-query",
      "event": "PostToolUse",
      "toolPattern": "WebFetch",
      "description": "Log threat intelligence queries for audit trail",
      "command": "bash .claude-plugin/hooks/scripts/log-threat-query.sh \"$URL\" \"$STATUS\"",
      "timeout": 1000,
      "failureMode": "ignore"
    },
    {
      "name": "check-api-keys",
      "event": "PreToolUse",
      "toolPattern": "WebFetch",
      "description": "Check if required API keys are configured for premium sources",
      "command": "bash .claude-plugin/hooks/scripts/check-api-keys.sh \"$URL\"",
      "timeout": 1000,
      "failureMode": "warn"
    },
    {
      "name": "verify-cache-saved",
      "event": "Stop",
      "description": "Verify threat cache was properly saved before session end",
      "command": "bash .claude-plugin/hooks/scripts/verify-cache-saved.sh",
      "timeout": 3000,
      "failureMode": "warn"
    }
  ]
}
