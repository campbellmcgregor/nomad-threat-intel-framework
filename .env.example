# NOMAD Threat Intelligence Framework Environment Configuration
# Copy this file to .env and fill in your actual values

# ============================================================================
# LLM API Configuration
# ============================================================================

# Anthropic Claude API Key (primary)
# Get your key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=your_anthropic_api_key_here

# OpenAI API Key (alternative - for future use)
# Get your key from: https://platform.openai.com/api-keys
OPENAI_API_KEY=your_openai_api_key_here

# ============================================================================
# Threat Intelligence Data Sources
# ============================================================================

# CVE Enrichment API Keys
NVD_API_KEY=your_nvd_api_key_here
MITRE_API_KEY=your_mitre_api_key_here

# EPSS (Exploit Prediction Scoring System) API
EPSS_API_URL=https://api.first.org/data/v1/epss

# CISA KEV (Known Exploited Vulnerabilities) Feed
CISA_KEV_URL=https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json

# ============================================================================
# External Threat Intelligence Sources
# ============================================================================

# VirusTotal API (for URL/hash analysis)
VIRUSTOTAL_API_KEY=your_virustotal_api_key_here

# Shodan API (for infrastructure analysis)
SHODAN_API_KEY=your_shodan_api_key_here

# ThreatFox API (for IOC enrichment)
THREATFOX_API_URL=https://threatfox-api.abuse.ch/api/v1/

# ============================================================================
# Logging and Monitoring
# ============================================================================

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Enable detailed API request logging
VERBOSE_LOGGING=false

# Syslog server (optional)
SYSLOG_SERVER=
SYSLOG_PORT=514

# ============================================================================
# Agent Configuration
# ============================================================================

# Default LLM model to use
DEFAULT_MODEL=claude-3-sonnet-20240229

# API timeout in seconds
API_TIMEOUT=300

# Maximum retries for failed API calls
MAX_RETRIES=3

# Rate limiting (requests per minute)
RATE_LIMIT_RPM=60

# ============================================================================
# Output Configuration
# ============================================================================

# Directory for agent outputs
OUTPUT_DIR=data/output

# Directory for agent inputs
INPUT_DIR=data/input

# Cache directory for API responses
CACHE_DIR=data/cache

# Enable output caching
ENABLE_CACHE=true

# Cache TTL in seconds (default: 1 hour)
CACHE_TTL=3600

# ============================================================================
# Security Configuration
# ============================================================================

# Encrypt cached API responses
ENCRYPT_CACHE=false

# Cache encryption key (generate with: openssl rand -base64 32)
CACHE_ENCRYPTION_KEY=

# Webhook URL for alerts (optional)
ALERT_WEBHOOK_URL=

# Webhook secret for validation
WEBHOOK_SECRET=

# ============================================================================
# Organization Context
# ============================================================================

# Organization name for reports
ORG_NAME=Your Organization

# Crown jewel systems (comma-separated)
CROWN_JEWELS=Exchange,Active Directory,Financial Systems,Customer Database

# Primary asset exposure types
ASSET_EXPOSURE=Internet-facing,Internal Network,Cloud Infrastructure

# Business sectors (for relevant threat filtering)
BUSINESS_SECTORS=Financial Services,Healthcare,Technology

# ============================================================================
# Development and Testing
# ============================================================================

# Enable development mode (more verbose logging, test data)
DEV_MODE=false

# Use test data instead of live feeds
USE_TEST_DATA=false

# Mock API responses for testing
MOCK_APIS=false

# Test RSS feed URL
TEST_RSS_FEED=https://example.com/test-feed.xml